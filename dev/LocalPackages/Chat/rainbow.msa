#Rainbow chat!

#todo? make actual rainbow colors, expanded to fit length(@msg) like ^0(...)

#standard rainbow chat: this selects a new random color for every letter in the message.
everyone:/rsay [$] = >>>
assign(@player, player())

if(has_permission(@player, 'commandhelper.alias.chat.use.rainbow'), null,
	die(color(c).'['.color(7).'Rainbow'.color(c).'] '.color(c).'You do not have permission to use Rainbow chat!')
)

if($ == '', die(color(c).'You didn\'t say anything!!'))
assign(@msg, strip_colors($))

	assign(@string, _rainbow(@msg, 'normal'))
	if(player() == '~console',
		broadcast(@string)
		,
		export(@name.'.player.'.@player.'.rainbow.cmd', true)
		chat(@string)
	)
<<<

#This selects a new random color for every other character in the message.
everyone:/rsay2 [$] = >>>
assign(@player, player())

if(has_permission(@player, 'commandhelper.alias.chat.use.rainbow'), null,
	die(color(c).'['.color(7).'Rainbow'.color(c).'] '.color(c).'You do not have permission to use Rainbow chat!')
)

if($ == '', die(color(c).'You didn\'t say anything!!'))


	assign(@string, _rainbow($, 'doubles'))

	if(player() == '~console',
		broadcast(@string)
		,
		export(@name.'.player.'.@player.'.rainbow.cmd', true)
		chat(@string)
	)
<<<


#This uses all the minecraft colors, not just specific colors.
everyone:/rsayall [$] = >>>
assign(@player, player())

if(has_permission(@player, 'commandhelper.alias.chat.use.rainbow'), null,
	die(color(c).'['.color(7).'Rainbow'.color(c).'] '.color(c).'You do not have permission to use Rainbow chat!')
)

if($ == '', die(color(c).'You didn\'t say anything!!'))


	assign(@string, _rainbow($, 'all'))

	if(player() == '~console',
		broadcast(@string)
		,
		export(@name.'.player.'.@player.'.rainbow.cmd', true)
		chat(@string)
	)
<<<


everyone:/rainbow [$action] [$option1] [$] = >>>
#toggle rainbow chat on/off
assign(@name, Rainbow)
assign(@action, $action)
assign(@option1, to_lower($option1))
assign(@player, player())
assign(@you, player())

if(has_permission(@player, 'commandhelper.alias.chat.use.rainbow'), null,
	die(color(c).'['.color(7).'Rainbow'.color(c).'] '.color(c).'You do not have permission to use Rainbow chat!')
)


if(@action == 'toggle',
	assign(@successmsg, color(red).'['.color(gold).@name.color(red).'] '.color(c).'Invalid setting specified. '.color(r).'Leave blank for normal rainbow chat, or type \'doubles\' to use doubles mode.')
	if(@option1 == '' || @option1 == null,
		assign(@oldvalue, get_value(@name.'.player.'.@player.'.rainbow.toggle'))
		if(@oldvalue == true,
			store_value(@name.'.player.'.@player.'.rainbow.toggle', false)
			export(@name.'.player.'.@player.'.rainbow.toggle', false)
			assign(@successmsg, color(7).'['.color(gold).@name.color(7).'] '.color(d). 'Automatic rainbow chat is now disabled!')
		,
		#enable
			store_value(@name.'.player.'.@player.'.rainbow.toggle', true)
			store_value(@name.'.player.'.@player.'.rainbow.type', 'normal')
			export(@name.'.player.'.@player.'.rainbow.toggle', true)
			export(@name.'.player.'.@player.'.rainbow.type', 'normal')
			assign(@successmsg, color(7).'['.color(gold).@name.color(7).'] '.color(d)._rainbow('Automatic rainbow chat is now enabled!').color(a).' Your chat will be like the colors of the rainbow now!')
		)
	)
	if(@option1 == 'doubles',
		store_value(@name.'.player.'.@player.'.rainbow.toggle', true)
		store_value(@name.'.player.'.@player.'.rainbow.type', 'doubles')
		export(@name.'.player.'.@player.'.rainbow.toggle', true)
		export(@name.'.player.'.@player.'.rainbow.type', 'doubles')
		assign(@successmsg, color(7).'['.color(gold).@name.color(7).'] '.color(d)._rainbow('Automatic rainbow chat is now enabled!', doubles).color(a).' Your chat will be like the colors of the rainbow now!')
	)
	die(@successmsg)
)


#No action? /rsay
assign(@string, @action @option1 $)
call_alias('/rsay '.@string)
<<<
